# AI Change Log — 2026-02-21

## Session: Phase 0 Program Setup

### What was built

Complete development infrastructure setup for Claude Code-driven development of SproutRoute. This covers all safety gates, CI/CD pipeline, reusable skills, and the CLAUDE.md context file that all future sessions will read first.

### Files created

| File | Purpose |
|------|---------|
| `.claude/settings.json` | Claude Code hooks: PreToolUse guard (blocks .env/package-lock edits), PostToolUse logger, Stop gate (npm test before session ends) |
| `.github/workflows/test.yml` | GitHub Actions CI: runs npm test + vite build on every push |
| `CLAUDE.md` | Project context for Claude Code: architecture map, critical files, commands, test patterns, branch strategy |
| `docs/AI_DELIVERY_PLAYBOOK.md` | AI delivery operating model: 4-phase workflow, quality gates, two-agent review pattern, prompt templates |
| `docs/ai-change-log/2026-02-21.md` | This file — first change log entry |
| `.claude/skills/tdd-feature.md` | TDD workflow skill with Red→Green→Refactor loop |
| `.claude/skills/add-api-route.md` | Template for adding Express endpoints with contract tests |
| `.claude/skills/add-component.md` | Template for React components with dark mode, a11y, PostHog |
| `.claude/skills/add-test.md` | Reference for test patterns (fetch mock, DI, Vitest) |
| `.claude/skills/fix-failing-test.md` | Systematic test debugging guide |
| `.claude/skills/deploy-checklist.md` | End-to-end verify + deploy sequence |

### Architecture decisions

- **Hooks in `.claude/settings.json`** (not `settings.local.json`) so they're checked into the repo and apply to all Claude Code sessions on this project, not just locally.
- **Stop hook runs `npm test`** — this means Claude Code cannot end a session with failing tests. Forces fix-before-finish discipline.
- **PreToolUse blocks `package-lock.json` and `.env` edits** — prevents accidental corruption of lockfile or leaking secrets into edits.
- **GitHub Actions CI** has commented-out jobs for contract tests (Phase 1) and mobile smoke (Phase 3) — enables them without creating a new workflow file.
- **CLAUDE.md at `strollerscout/` root** — this is where Claude Code sessions run for the app, so it's the right location for Claude to pick up automatically.
- **Skills in `.claude/skills/`** with markdown files — Claude Code can reference these via `/[skill-name]` or by asking Claude to "follow the [skill] skill."

### Prompt patterns that worked well

- "Read CLAUDE.md first. Then explore [area] in plan mode." — grounds Claude in project context before any changes.
- Listing exact test patterns in CLAUDE.md means Claude can copy them without hallucinating new patterns.

### Prior session decisions captured

From the planning session (same date):
- **Mobile:** Expo React Native, iOS + Android parallel
- **International Phase 1:** Canada, UK, Australia
- **AI model:** DeepSeek V3 A/B vs Claude Haiku via eval tool
- **API:** `/api/v1` versioned endpoints, legacy aliases for one cycle
- **Privacy:** No accounts, on-device storage, 7-day TTL, anonymous PostHog analytics
- **UX audit:** 14 issues identified (6 CRITICAL, 8 IMPORTANT) — see Phase 2 plan

### Next session (Phase 1 — Mar 2)

1. Complete SproutRoute name migration (`server.js`, `PRD.md`, `start.sh`)
2. Add `/api/v1` versioned endpoints + standard error envelope
3. Create `src/shared/types/` TypeScript contracts package
4. Set up CI on GitHub (push `.github/workflows/test.yml`)

Prompt to start Phase 1:
```
"Read CLAUDE.md first. We're starting Phase 1: Rebrand + API Foundation.
 First task: complete the SproutRoute name migration.
 Find all remaining StrollerScout references in server.js, PRD.md, and start.sh.
 Use TDD — write a test that verifies the health endpoint returns 'SproutRoute'
 before making any changes."
```
